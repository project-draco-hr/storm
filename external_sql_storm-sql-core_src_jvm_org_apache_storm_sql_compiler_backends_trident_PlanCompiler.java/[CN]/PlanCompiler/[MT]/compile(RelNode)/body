{
  TridentTopology topology=new TridentTopology();
  TridentLogicalPlanCompiler compiler=new TridentLogicalPlanCompiler(sources,typeFactory,topology);
  compiler.traverse(plan);
  return topology;
}
