{
  Map ret=new HashMap();
  Set workerSet=(Set)getByKeyword(accStats,WORKERS_SET);
  Map bolt2stats=getMapByKeyword(accStats,BOLT_TO_STATS);
  Map spout2stats=getMapByKeyword(accStats,SPOUT_TO_STATS);
  Map win2emitted=getMapByKeyword(accStats,WIN_TO_EMITTED);
  Map win2transferred=getMapByKeyword(accStats,WIN_TO_TRANSFERRED);
  Map win2compLatWgtAvg=getMapByKeyword(accStats,WIN_TO_COMP_LAT_WGT_AVG);
  Map win2acked=getMapByKeyword(accStats,WIN_TO_ACKED);
  Map win2failed=getMapByKeyword(accStats,WIN_TO_FAILED);
  Map stats=getMapByKeyword(newData,STATS);
  boolean isSpout=compType.equals(SPOUT);
  Map cid2stat2num;
  if (isSpout) {
    cid2stat2num=aggPreMergeTopoPageSpout(newData,window,includeSys);
  }
 else {
    cid2stat2num=aggPreMergeTopoPageBolt(newData,window,includeSys);
  }
  Map w2compLatWgtAvg, w2acked;
  Map compLatStats=getMapByKeyword(stats,COMP_LATENCIES);
  if (isSpout) {
    Map mm=new HashMap();
    Map acked=getMapByKeyword(stats,ACKED);
    for (    Object win : acked.keySet()) {
      mm.put(win,aggSpoutLatAndCount((Map)compLatStats.get(win),(Map)acked.get(win)));
    }
    mm=swapMapOrder(mm);
    w2compLatWgtAvg=getMapByKeyword(mm,COMP_LAT_TOTAL);
    w2acked=getMapByKeyword(mm,ACKED);
  }
 else {
    w2compLatWgtAvg=null;
    w2acked=aggregateCountStreams(getMapByKeyword(stats,ACKED));
  }
  workerSet.add(Lists.newArrayList(getByKeyword(newData,HOST),getByKeyword(newData,PORT)));
  putRawKV(ret,WORKERS_SET,workerSet);
  putRawKV(ret,BOLT_TO_STATS,bolt2stats);
  putRawKV(ret,SPOUT_TO_STATS,spout2stats);
  putRawKV(ret,WIN_TO_EMITTED,mergeWithSum(win2emitted,aggregateCountStreams(filterSysStreams(getMapByKeyword(stats,EMITTED),includeSys))));
  putRawKV(ret,WIN_TO_TRANSFERRED,mergeWithSum(win2transferred,aggregateCountStreams(filterSysStreams(getMapByKeyword(stats,TRANSFERRED),includeSys))));
  putRawKV(ret,WIN_TO_COMP_LAT_WGT_AVG,mergeWithSum(win2compLatWgtAvg,w2compLatWgtAvg));
  putRawKV(ret,WIN_TO_ACKED,isSpout ? mergeWithSum(win2acked,w2acked) : win2acked);
  putRawKV(ret,WIN_TO_FAILED,isSpout ? mergeWithSum(aggregateCountStreams(getMapByKeyword(stats,FAILED)),win2failed) : win2failed);
  putRawKV(ret,TYPE,getByKeyword(stats,TYPE));
  if (isSpout) {
    Set<Object> keySet=new HashSet<>();
    keySet.addAll(spout2stats.keySet());
    keySet.addAll(cid2stat2num.keySet());
    Map mm=new HashMap();
    for (    Object k : keySet) {
      mm.put(k,mergeAggCompStatsTopoPageSpout((Map)spout2stats.get(k),(Map)cid2stat2num.get(k)));
    }
    putRawKV(ret,SPOUT_TO_STATS,mm);
  }
 else {
    Set<Object> keySet=new HashSet<>();
    keySet.addAll(bolt2stats.keySet());
    keySet.addAll(cid2stat2num.keySet());
    Map mm=new HashMap();
    for (    Object k : keySet) {
      mm.put(k,mergeAggCompStatsTopoPageBolt((Map)bolt2stats.get(k),(Map)cid2stat2num.get(k)));
    }
    putRawKV(ret,BOLT_TO_STATS,mm);
  }
  return ret;
}
