{
  if (!includeSys) {
    for (Iterator itr=stats.keySet().iterator(); itr.hasNext(); ) {
      Object winOrStream=itr.next();
      if (isWindow(winOrStream)) {
        Map stream2stat=(Map)stats.get(winOrStream);
        for (Iterator subItr=stream2stat.keySet().iterator(); subItr.hasNext(); ) {
          Object key=subItr.next();
          if (key instanceof String && Utils.isSystemId((String)key)) {
            subItr.remove();
          }
        }
      }
 else {
        if (winOrStream instanceof String && Utils.isSystemId((String)winOrStream)) {
          itr.remove();
        }
      }
    }
  }
  return stats;
}
