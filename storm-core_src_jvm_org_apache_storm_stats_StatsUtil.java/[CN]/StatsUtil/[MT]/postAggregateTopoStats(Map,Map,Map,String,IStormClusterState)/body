{
  Map ret=new HashMap();
  putRawKV(ret,NUM_TASKS,task2comp.size());
  putRawKV(ret,NUM_WORKERS,((Set)getByKeyword(accData,WORKERS_SET)).size());
  putRawKV(ret,NUM_EXECUTORS,exec2nodePort != null ? exec2nodePort.size() : 0);
  Map bolt2stats=getMapByKeyword(accData,BOLT_TO_STATS);
  Map aggBolt2stats=new HashMap();
  for (  Object o : bolt2stats.entrySet()) {
    Map.Entry e=(Map.Entry)o;
    String id=(String)e.getKey();
    Map m=(Map)e.getValue();
    long executed=getByKeywordOr0(m,EXECUTED).longValue();
    if (executed > 0) {
      double execLatencyTotal=getByKeywordOr0(m,EXEC_LAT_TOTAL).doubleValue();
      putRawKV(m,EXEC_LATENCY,execLatencyTotal / executed);
      double procLatencyTotal=getByKeywordOr0(m,PROC_LAT_TOTAL).doubleValue();
      putRawKV(m,PROC_LATENCY,procLatencyTotal / executed);
    }
    removeByKeyword(m,EXEC_LAT_TOTAL);
    removeByKeyword(m,PROC_LAT_TOTAL);
    putRawKV(m,"last-error",getLastError(clusterState,topologyId,id));
    aggBolt2stats.put(id,m);
  }
  putRawKV(ret,BOLT_TO_STATS,aggBolt2stats);
  Map spout2stats=getMapByKeyword(accData,SPOUT_TO_STATS);
  Map spoutBolt2stats=new HashMap();
  for (  Object o : spout2stats.entrySet()) {
    Map.Entry e=(Map.Entry)o;
    String id=(String)e.getKey();
    Map m=(Map)e.getValue();
    long acked=getByKeywordOr0(m,ACKED).longValue();
    if (acked > 0) {
      double compLatencyTotal=getByKeywordOr0(m,COMP_LAT_TOTAL).doubleValue();
      putRawKV(m,COMP_LATENCY,compLatencyTotal / acked);
    }
    removeByKeyword(m,COMP_LAT_TOTAL);
    putRawKV(m,"last-error",getLastError(clusterState,topologyId,id));
    spoutBolt2stats.put(id,m);
  }
  putRawKV(ret,SPOUT_TO_STATS,spoutBolt2stats);
  putRawKV(ret,WIN_TO_EMITTED,mapKeyStr(getMapByKeyword(accData,WIN_TO_EMITTED)));
  putRawKV(ret,WIN_TO_TRANSFERRED,mapKeyStr(getMapByKeyword(accData,WIN_TO_TRANSFERRED)));
  putRawKV(ret,WIN_TO_ACKED,mapKeyStr(getMapByKeyword(accData,WIN_TO_ACKED)));
  putRawKV(ret,WIN_TO_FAILED,mapKeyStr(getMapByKeyword(accData,WIN_TO_FAILED)));
  putRawKV(ret,WIN_TO_COMP_LAT,computeWeightedAveragesPerWindow(accData,WIN_TO_COMP_LAT_WGT_AVG,WIN_TO_ACKED));
  return ret;
}
