{
  String stormRoot=ConfigUtils.supervisorStormDistRoot(conf,stormId);
  Map stormConf=ConfigUtils.readSupervisorStormConf(conf,stormId);
  String workerRoot=ConfigUtils.workerRoot(conf,workerId);
  Map<String,Map<String,Object>> blobstoreMap=(Map<String,Map<String,Object>>)stormConf.get(Config.TOPOLOGY_BLOBSTORE_MAP);
  List<String> blobFileNames=new ArrayList<>();
  if (blobstoreMap != null) {
    for (    Map.Entry<String,Map<String,Object>> entry : blobstoreMap.entrySet()) {
      String key=entry.getKey();
      Map<String,Object> blobInfo=entry.getValue();
      String ret=null;
      if (blobInfo != null && blobInfo.containsKey("localname")) {
        ret=(String)blobInfo.get("localname");
      }
 else {
        ret=key;
      }
      blobFileNames.add(ret);
    }
  }
  List<String> resourceFileNames=new ArrayList<>();
  resourceFileNames.add(ConfigUtils.RESOURCES_SUBDIR);
  resourceFileNames.addAll(blobFileNames);
  LOG.info("Creating symlinks for worker-id: {} storm-id: {} for files({}): {}",workerId,stormId,resourceFileNames.size(),resourceFileNames);
  Utils.createSymlink(workerRoot,stormRoot,ConfigUtils.RESOURCES_SUBDIR);
  for (  String fileName : blobFileNames) {
    Utils.createSymlink(workerRoot,stormRoot,fileName,fileName);
  }
}
