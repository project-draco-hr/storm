{
  for (  TopicPartition tp : consumerRecords.partitions()) {
    final Iterable<ConsumerRecord<K,V>> records=consumerRecords.records(tp.topic());
    for (    final ConsumerRecord<K,V> record : records) {
      final List<Object> tuple=tupleBuilder.buildTuple(record,kafkaSpoutStreams);
      final KafkaSpoutMessageId messageId=new KafkaSpoutMessageId(record,tuple);
      kafkaSpoutStreams.emit(collector,messageId);
      LOG.trace("Emitted tuple [{}] for record [{}]",tuple,record);
    }
  }
}
