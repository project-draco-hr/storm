{
  final KafkaSpoutMessageId msgId=(KafkaSpoutMessageId)messageId;
  if (!consumerAutoCommitMode) {
    acked.get(msgId.getTopicPartition()).add(msgId);
    LOG.trace("Acked message [{}]. Messages acked and pending commit [{}]",msgId,acked);
  }
  emitted.remove(msgId);
}
