{
  Object msg=e.getMessage();
  if (msg == null)   return;
  if (msg.equals(ControlMessage.eobMessage())) {
    Channel channel=ctx.getChannel();
    LOG.debug("Send back response ...");
    if (failure_count.get() == 0)     channel.write(ControlMessage.okResponse());
 else     channel.write(ControlMessage.failureResponse());
    return;
  }
  try {
    server.enqueue((TaskMessage)msg);
  }
 catch (  InterruptedException e1) {
    LOG.info("failed to enqueue a request message",e);
    failure_count.incrementAndGet();
  }
}
