{
  try {
    String nimbusHost=(String)conf.get(Config.NIMBUS_HOST);
    int nimbusPort=Utils.getInt(conf.get(Config.NIMBUS_THRIFT_PORT));
    Integer timeout=new Integer(Utils.getInt(conf.get(Config.NIMBUS_TASK_TIMEOUT_SECS)));
    return new NimbusClient(conf,nimbusHost,nimbusPort,timeout);
  }
 catch (  TTransportException ex) {
    LOG.info(ex.getMessage(),ex);
    throw new RuntimeException(ex);
  }
}
