{
  int hostIndex=partition / _config.partitionsPerHost;
  if (!_kafka.containsKey(hostIndex)) {
    HostPort hp=_config.hosts.get(hostIndex);
    _kafka.put(hostIndex,new SimpleConsumer(hp.host,hp.port,_config.socketTimeoutMs,_config.bufferSizeBytes));
  }
  return _kafka.get(hostIndex);
}
