{
  try {
    List<String> brokers=_zkClient.getChildren(_brokerZkPath,false);
    for (int i=0; i < brokers.size(); i++) {
      String path=brokers.get(i);
      HostPort hp=getBrokerHost(path);
      _kafka.put(i,new SimpleConsumer(hp.host,hp.port,_config.socketTimeoutMs,_config.bufferSizeBytes));
    }
  }
 catch (  KeeperException e) {
    throw new RuntimeException("Could not get brokers: " + e);
  }
catch (  InterruptedException e) {
    throw new RuntimeException("Error while creating zkClient: " + e);
  }
}
