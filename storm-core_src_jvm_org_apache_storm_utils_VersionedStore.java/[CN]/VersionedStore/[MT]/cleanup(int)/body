{
  List<Long> versions=getAllVersions();
  if (versionsToKeep >= 0) {
    versions=versions.subList(0,Math.min(versions.size(),versionsToKeep));
  }
  HashSet<Long> keepers=new HashSet<Long>(versions);
  try (DirectoryStream<Path> directoryStream=Files.newDirectoryStream(new File(_root).toPath())){
    for (    Path path : directoryStream) {
      Long v=parseVersion(path.toAbsolutePath().toString());
      if (v != null && !keepers.contains(v)) {
        deleteVersion(v);
      }
    }
  }
 }
