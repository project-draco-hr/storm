{
  try {
    HashSet<URL> resources=new HashSet<URL>(findResources(name));
    if (resources.isEmpty()) {
      if (mustExist)       throw new RuntimeException("Could not find config file on classpath " + name);
 else       return new HashMap();
    }
    if (resources.size() > 1) {
      throw new RuntimeException("Found multiple " + name + " resources. You're probably bundling the Storm jars with your topology jar. "+ resources);
    }
    URL resource=resources.iterator().next();
    Yaml yaml=new Yaml(new SafeConstructor());
    Map ret=null;
    InputStream input=resource.openStream();
    try {
      ret=(Map)yaml.load(new InputStreamReader(input));
    }
  finally {
      input.close();
    }
    if (ret == null)     ret=new HashMap();
    return new HashMap(ret);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
