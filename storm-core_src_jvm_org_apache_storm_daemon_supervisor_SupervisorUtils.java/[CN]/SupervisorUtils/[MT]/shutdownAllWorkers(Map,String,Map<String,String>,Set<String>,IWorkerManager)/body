{
  Collection<String> workerIds=SupervisorUtils.supervisorWorkerIds(conf);
  try {
    for (    String workerId : workerIds) {
      workerManager.shutdownWorker(supervisorId,workerId,workerThreadPids);
      boolean success=workerManager.cleanupWorker(workerId);
      if (success) {
        deadWorkers.remove(workerId);
      }
    }
  }
 catch (  Exception e) {
    LOG.error("shutWorker failed");
    throw Utils.wrapInRuntime(e);
  }
}
