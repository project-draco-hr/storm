{
  long offset;
  for (  TridentTuple tuple : tuples) {
synchronized (this.writeLock) {
      this.writer.append(this.format.key(tuple),this.format.value(tuple));
      offset=this.writer.getLength();
    }
    if (this.rotationPolicy.mark(tuple,offset)) {
      rotateOutputFile();
      this.rotationPolicy.reset();
    }
  }
}
