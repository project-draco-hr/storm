{
  DelimitedRecordHiveMapper mapper=new DelimitedRecordHiveMapper().withColumnFields(new Fields(colNames)).withPartitionFields(new Fields(partNames));
  HiveOptions hiveOptions=new HiveOptions(metaStoreURI,dbName,tblName,mapper).withTxnsPerBatch(2).withBatchSize(2);
  bolt=new HiveBolt(hiveOptions);
  bolt.prepare(config,null,new OutputCollector(collector));
  Integer id=100;
  String msg="test-123";
  String city="sunnyvale";
  String state="ca";
  checkRecordCountInTable(tblName,dbName,0);
  for (int i=0; i < 4; i++) {
    Tuple tuple=generateTestTuple(id,msg,city,state);
    bolt.execute(tuple);
    verify(collector).ack(tuple);
  }
  checkRecordCountInTable(tblName,dbName,4);
  bolt.cleanup();
}
