{
  BulkRequestBuilder bulkRequest=client.prepareBulk();
  for (  TridentTuple tuple : tuples) {
    String index=tuple.getStringByField("index");
    String type=tuple.getStringByField("type");
    String source=tuple.getStringByField("source");
    bulkRequest.add(client.prepareIndex(index,type).setSource(source));
  }
  BulkResponse bulkResponse=bulkRequest.execute().actionGet();
  if (bulkResponse.hasFailures()) {
    LOG.warn("failed processing bulk index requests " + bulkResponse.buildFailureMessage());
    throw new FailedException();
  }
}
