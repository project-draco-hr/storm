{
  try {
    String source=tuple.getStringByField("source");
    String index=tuple.getStringByField("index");
    String type=tuple.getStringByField("type");
    PercolateResponse response=client.preparePercolate().setIndices(index).setDocumentType(type).setPercolateDoc(PercolateSourceBuilder.docBuilder().setDoc(source)).execute().actionGet();
    if (response.getCount() > 0) {
      for (      PercolateResponse.Match match : response) {
        String id=match.getId().toString();
        collector.emit(new Values(id));
      }
    }
    collector.ack(tuple);
  }
 catch (  Exception e) {
    e.printStackTrace();
    collector.reportError(e);
    collector.fail(tuple);
  }
}
