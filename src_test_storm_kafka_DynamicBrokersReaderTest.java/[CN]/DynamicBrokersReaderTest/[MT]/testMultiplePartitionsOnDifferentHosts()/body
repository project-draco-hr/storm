{
  String host="localhost";
  int port=9092;
  int secondPort=9093;
  int partition=0;
  int secondPartition=partition + 1;
  addPartition(partition,0,host,port);
  addPartition(secondPartition,1,host,secondPort);
  GlobalPartitionInformation brokerInfo=dynamicBrokersReader.getBrokerInfo();
  assertEquals(2,brokerInfo.getOrderedPartitions().size());
  assertEquals(port,brokerInfo.getHostFor(partition).port);
  assertEquals(host,brokerInfo.getHostFor(partition).host);
  assertEquals(secondPort,brokerInfo.getHostFor(secondPartition).port);
  assertEquals(host,brokerInfo.getHostFor(secondPartition).host);
}
