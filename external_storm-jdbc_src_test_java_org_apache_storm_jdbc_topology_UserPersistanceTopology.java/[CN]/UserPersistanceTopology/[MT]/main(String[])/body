{
  if (args.length < 5) {
    System.out.println("Usage: UserPersistanceTopology <dataSourceClassName> <dataSource.url> " + "<user> <password> <tableName> [topology name]");
  }
  Map map=Maps.newHashMap();
  map.put("dataSourceClassName",args[0]);
  map.put("dataSource.url",args[1]);
  map.put("dataSource.user",args[2]);
  map.put("dataSource.password",args[3]);
  String tableName=args[4];
  JdbcMapper jdbcMapper=new SimpleJdbcMapper(tableName,map);
  Config config=new Config();
  config.put("jdbc.conf",map);
  UserSpout spout=new UserSpout();
  JdbcBolt bolt=new JdbcBolt(tableName,jdbcMapper).withConfigKey("jdbc.conf");
  TopologyBuilder builder=new TopologyBuilder();
  builder.setSpout(USER_SPOUT,spout,1);
  builder.setBolt(USER_BOLT,bolt,1).shuffleGrouping(USER_SPOUT);
  if (args.length == 5) {
    LocalCluster cluster=new LocalCluster();
    cluster.submitTopology("test",config,builder.createTopology());
    Thread.sleep(30000);
    cluster.killTopology("test");
    cluster.shutdown();
    System.exit(0);
  }
 else   if (args.length == 6) {
    StormSubmitter.submitTopology(args[6],config,builder.createTopology());
  }
 else {
    System.out.println("Usage: UserPersistanceTopology <dataSourceClassName> <dataSource.url> " + "<user> <password> <tableName> [topology name]");
  }
}
