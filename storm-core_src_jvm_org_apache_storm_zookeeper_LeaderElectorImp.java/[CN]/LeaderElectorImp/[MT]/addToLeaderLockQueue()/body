{
  try {
    if (LeaderLatch.State.CLOSED.equals(leaderLatch.get().getState())) {
      leaderLatch.set(new LeaderLatch(zk,leaderlockPath));
      leaderLatchListener.set(Zookeeper.leaderLatchListenerImpl(conf,zk,leaderLatch.get()));
    }
    if (LeaderLatch.State.LATENT.equals(leaderLatch.get().getState())) {
      leaderLatch.get().addListener(leaderLatchListener.get());
      leaderLatch.get().start();
      LOG.info("Queued up for leader lock.");
    }
 else {
      LOG.info("Node already in queue for leader lock.");
    }
  }
 catch (  Exception e) {
    LOG.warn("failed to add LeaderLatchListener",e);
  }
}
