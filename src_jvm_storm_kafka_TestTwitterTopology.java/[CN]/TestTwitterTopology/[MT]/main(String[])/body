{
  List<String> hosts=new ArrayList<String>();
  hosts.add("smf1-atc-13-sr1.prod.twitter.com");
  hosts.add("smf1-atx-26-sr1.prod.twitter.com");
  hosts.add("smf1-atw-05-sr4.prod.twitter.com");
  hosts.add("smf1-aty-37-sr4.prod.twitter.com");
  KafkaConfig kafkaConf=KafkaConfig.fromHostStrings(hosts,8,"firehose");
  kafkaConf.scheme=new StringScheme();
  kafkaConf.forceStartOffsetTime(-1);
  TransactionalTopologyBuilder builder=new TransactionalTopologyBuilder("id","spout",new OpaqueTransactionalKafkaSpout(kafkaConf),1);
  builder.setBolt("printer",new PrinterBolt()).shuffleGrouping("spout");
  Config config=new Config();
  StormSubmitter.submitTopology("kafka-test",config,builder.buildTopology());
}
