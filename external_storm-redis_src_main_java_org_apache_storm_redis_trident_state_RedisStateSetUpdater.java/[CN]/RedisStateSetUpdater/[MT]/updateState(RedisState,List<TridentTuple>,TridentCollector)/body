{
  long expireAt=System.currentTimeMillis() + expireIntervalMs;
  JedisCommands jedisCommands=null;
  try {
    jedisCommands=redisState.getInstance();
    for (    TridentTuple input : inputs) {
      String key=this.tupleMapper.getKeyFromTridentTuple(input);
      String redisKey=key;
      if (redisKeyPrefix != null && redisKeyPrefix.length() > 0) {
        redisKey=redisKeyPrefix + redisKey;
      }
      String value=this.tupleMapper.getValueFromTridentTuple(input);
      logger.debug("update key[" + key + "] redisKey["+ redisKey+ "] value["+ value+ "]");
      jedisCommands.sadd(redisKey,value);
      jedisCommands.expireAt(redisKey,expireAt);
      Long count=jedisCommands.scard(redisKey);
      collector.emit(new Values(key,count));
    }
  }
  finally {
    if (jedisCommands != null) {
      redisState.returnInstance(jedisCommands);
    }
  }
}
