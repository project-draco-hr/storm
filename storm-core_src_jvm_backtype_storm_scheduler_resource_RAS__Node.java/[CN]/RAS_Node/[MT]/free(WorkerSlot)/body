{
  LOG.info("freeing ws {} on node {}",ws,this.hostname);
  if (this.freeSlots.contains(ws))   return;
  for (  Entry<String,Set<WorkerSlot>> entry : this.topIdToUsedSlots.entrySet()) {
    Set<WorkerSlot> slots=entry.getValue();
    double memUsed=this.getMemoryUsedByWorker(ws);
    double cpuUsed=this.getCpuUsedByWorker(ws);
    if (slots.remove(ws)) {
      this.cluster.freeSlot(ws);
      if (this.isAlive) {
        this.freeSlots.add(ws);
      }
      this.freeMemory(memUsed);
      this.freeCPU(cpuUsed);
      return;
    }
  }
  throw new IllegalArgumentException("Tried to free a slot that was not" + " part of this node " + this.nodeId);
}
