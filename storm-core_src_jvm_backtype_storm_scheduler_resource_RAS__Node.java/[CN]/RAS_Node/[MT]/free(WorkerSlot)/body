{
  LOG.info("freeing ws {} on node {}",ws,_hostname);
  if (_freeSlots.contains(ws))   return;
  for (  Entry<String,Set<WorkerSlot>> entry : _topIdToUsedSlots.entrySet()) {
    Set<WorkerSlot> slots=entry.getValue();
    double memUsed=this.getMemoryUsedByWorker(ws);
    double cpuUsed=this.getCpuUsedByWorker(ws);
    if (slots.remove(ws)) {
      _cluster.freeSlot(ws);
      if (_isAlive) {
        _freeSlots.add(ws);
      }
      this.freeMemory(memUsed);
      this.freeCPU(cpuUsed);
      return;
    }
  }
  throw new IllegalArgumentException("Tried to free a slot that was not" + " part of this node " + _nodeId);
}
