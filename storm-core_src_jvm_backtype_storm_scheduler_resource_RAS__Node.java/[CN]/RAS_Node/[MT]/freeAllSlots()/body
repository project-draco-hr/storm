{
  if (!this.isAlive) {
    LOG.warn("Freeing all slots on a dead node {} ",this.nodeId);
  }
  for (  Entry<String,Set<WorkerSlot>> entry : this.topIdToUsedSlots.entrySet()) {
    this.cluster.freeSlots(entry.getValue());
    this.availCPU=this.getTotalCpuResources();
    this.availMemory=this.getAvailableMemoryResources();
    if (this.isAlive) {
      this.freeSlots.addAll(entry.getValue());
    }
  }
  this.topIdToUsedSlots=new HashMap<String,Set<WorkerSlot>>();
}
