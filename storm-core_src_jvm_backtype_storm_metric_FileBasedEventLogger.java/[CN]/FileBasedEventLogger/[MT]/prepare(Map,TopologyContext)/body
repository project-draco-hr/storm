{
  String logDir;
  String stormId=context.getStormId();
  int port=context.getThisWorkerPort();
  if ((logDir=System.getProperty("storm.local.dir")) == null && (logDir=(String)stormConf.get("storm.local.dir")) == null) {
    String msg="Could not determine the directory to log events.";
    LOG.error(msg);
    throw new RuntimeException(msg);
  }
 else {
    LOG.info("FileBasedEventLogger log directory {}.",logDir);
  }
  Path path=Paths.get(logDir,"workers-artifacts",stormId,Integer.toString(port),"events.log");
  if (!path.isAbsolute()) {
    path=Paths.get(System.getProperty("storm.home"),logDir,"workers-artifacts",stormId,Integer.toString(port),"events.log");
  }
  File dir=path.toFile().getParentFile();
  if (!dir.exists()) {
    dir.mkdirs();
  }
  initLogWriter(path);
  setUpFlushTask();
}
