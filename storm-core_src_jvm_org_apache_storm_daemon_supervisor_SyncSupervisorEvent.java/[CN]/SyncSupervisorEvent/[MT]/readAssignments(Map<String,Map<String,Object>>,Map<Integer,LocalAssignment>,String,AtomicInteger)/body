{
  try {
    Map<Integer,LocalAssignment> portLA=new HashMap<Integer,LocalAssignment>();
    for (    Map.Entry<String,Map<String,Object>> assignEntry : assignmentsSnapshot.entrySet()) {
      String stormId=assignEntry.getKey();
      Assignment assignment=(Assignment)assignEntry.getValue().get(IStateStorage.DATA);
      Map<Integer,LocalAssignment> portTasks=readMyExecutors(stormId,assignmentId,assignment);
      for (      Map.Entry<Integer,LocalAssignment> entry : portTasks.entrySet()) {
        Integer port=entry.getKey();
        LocalAssignment la=entry.getValue();
        if (!portLA.containsKey(port)) {
          portLA.put(port,la);
        }
 else {
          throw new RuntimeException("Should not have multiple topologys assigned to one port");
        }
      }
    }
    retries.set(0);
    return portLA;
  }
 catch (  RuntimeException e) {
    if (retries.get() > 2) {
      throw e;
    }
 else {
      retries.addAndGet(1);
    }
    LOG.warn("{} : retrying {} of 3",e.getMessage(),retries.get());
    return existingAssignment;
  }
}
