{
  if (!ackEnabled) {
    log.debug("Ack() called but acker count = 0",msgId,spoutId);
    return;
  }
  log.debug("Ack received for msg {} on spout {}",msgId,spoutId);
  MessageId id=(MessageId)msgId;
  inflight.remove(id);
  ++acksSinceLastCommit;
  tracker.recordAckedOffset(id.offset);
  commitProgress(tracker.getCommitPosition());
  if (fileReadCompletely && inflight.isEmpty()) {
    markFileAsDone(reader.getFilePath());
    reader=null;
  }
  super.ack(msgId);
}
