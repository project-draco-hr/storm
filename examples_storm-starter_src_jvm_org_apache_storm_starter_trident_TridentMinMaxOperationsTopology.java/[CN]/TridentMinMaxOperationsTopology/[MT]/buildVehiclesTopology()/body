{
  FixedBatchSpout spout=new FixedBatchSpout(new Fields("vehicle","driver"),10,Vehicle.generateVehicles(20));
  spout.setCycle(true);
  TridentTopology topology=new TridentTopology();
  Stream vehiclesStream=topology.newStream("spout1",spout).each(new Fields("vehicle"),new Debug("##### vehicles"));
  vehiclesStream.min(new SpeedComparator()).each(new Fields("vehicle"),new Debug("#### slowest vehicle")).project(new Fields("driver")).each(new Fields("driver"),new Debug("##### slowest driver"));
  vehiclesStream.max(new SpeedComparator()).each(new Fields("vehicle"),new Debug("#### fastest vehicle")).project(new Fields("driver")).each(new Fields("driver"),new Debug("##### fastest driver"));
  vehiclesStream.max(new EfficiencyComparator()).each(new Fields("vehicle"),new Debug("#### efficient vehicle"));
  return topology.build();
}
