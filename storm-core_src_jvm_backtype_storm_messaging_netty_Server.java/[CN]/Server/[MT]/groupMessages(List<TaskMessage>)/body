{
  ArrayList<TaskMessage> messageGroups[]=new ArrayList[queueCount];
  for (  TaskMessage message : msgs) {
    int task=message.task();
    if (task == -1) {
      closing=true;
      return null;
    }
    Integer queueId=getMessageQueueId(task);
    if (null == messageGroups[queueId]) {
      messageGroups[queueId]=new ArrayList<>();
    }
    messageGroups[queueId].add(message);
  }
  return messageGroups;
}
