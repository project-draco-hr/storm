{
  message_queue=new LinkedBlockingQueue<TaskMessage>();
  retries=0;
  int buffer_size=Utils.getInt(storm_conf.get(Config.STORM_MESSAGING_NETTY_BUFFER_SIZE));
  max_retries=Utils.getInt(storm_conf.get(Config.STORM_MESSAGING_NETTY_MAX_RETRIES));
  base_sleep_ms=Utils.getInt(storm_conf.get(Config.STORM_MESSAGING_NETTY_MIN_SLEEP_MS));
  max_sleep_ms=Utils.getInt(storm_conf.get(Config.STORM_MESSAGING_NETTY_MAX_SLEEP_MS));
  factory=new NioClientSocketChannelFactory(Executors.newCachedThreadPool(),Executors.newCachedThreadPool());
  bootstrap=new ClientBootstrap(factory);
  bootstrap.setOption("tcpNoDelay",true);
  bootstrap.setOption("sendBufferSize",buffer_size);
  bootstrap.setOption("keepAlive",true);
  bootstrap.setPipelineFactory(new StormClientPipelineFactory(this,storm_conf));
  remote_addr=new InetSocketAddress(host,port);
  ChannelFuture future=bootstrap.connect(remote_addr);
  channel=future.getChannel();
}
