{
  if (!closing) {
    if (null != messageBatch && !messageBatch.isEmpty()) {
      MessageBatch toBeFlushed=messageBatch;
      Channel channel=channelRef.get();
      if (channel != null) {
        flushCheckTimer.set(Long.MAX_VALUE);
        flushRequest(channel,toBeFlushed,true);
      }
      messageBatch=null;
    }
  }
}
