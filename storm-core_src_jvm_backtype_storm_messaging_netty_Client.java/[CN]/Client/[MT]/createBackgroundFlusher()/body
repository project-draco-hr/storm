{
  return new Runnable(){
    @Override public void run(){
      if (!closing && backgroundFlushingEnabled.get() && nowMillis() > nextBackgroundFlushTimeMs.get()) {
        LOG.debug("flushing {} pending messages to {} in background",messageBatch.size(),dstAddressPrefixedName);
        flushPendingMessages();
      }
    }
  }
;
}
