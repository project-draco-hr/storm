{
  K key=null;
  if (input.contains(BOLT_KEY)) {
    key=(K)input.getValueByField(BOLT_KEY);
  }
  V message=(V)input.getValueByField(BOLT_MESSAGE);
  try {
    producer.send(new KeyedMessage<K,V>(topic,key,message));
  }
 catch (  Exception ex) {
    LOG.error("Could not send message with key '" + key + "' and value '"+ message+ "'",ex);
  }
 finally {
    collector.ack(input);
  }
}
