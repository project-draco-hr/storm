{
  LOG.debug("Preparing...");
  ConsoleReporter.Builder builder=ConsoleReporter.forRegistry(metricsRegistry);
  PrintStream stream=System.out;
  if (stream != null) {
    builder.outputTo(stream);
  }
  Locale locale=MetricsUtils.getMetricsReporterLocale(stormConf);
  if (locale != null) {
    builder.formattedFor(locale);
  }
  TimeUnit rateUnit=MetricsUtils.getMetricsRateUnit(stormConf);
  if (rateUnit != null) {
    builder.convertRatesTo(rateUnit);
  }
  TimeUnit durationUnit=MetricsUtils.getMetricsDurationUnit(stormConf);
  if (durationUnit != null) {
    builder.convertDurationsTo(durationUnit);
  }
  reporter=builder.build();
}
