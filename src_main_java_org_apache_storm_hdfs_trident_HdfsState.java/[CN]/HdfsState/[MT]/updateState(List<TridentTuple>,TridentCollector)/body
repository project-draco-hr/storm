{
  try {
    for (    TridentTuple tuple : tuples) {
      byte[] bytes=this.options.format.format(tuple);
      out.write(bytes);
      this.offset+=bytes.length;
      if (this.options.rotationPolicy.mark(tuple,this.offset)) {
        rotateOutputFile();
        this.options.rotationPolicy.reset();
        this.offset=0;
      }
    }
  }
 catch (  IOException e) {
    LOG.warn("Failing batch due to IOException.",e);
    throw new FailedException(e);
  }
}
