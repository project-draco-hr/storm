{
  List<Integer> boltIds=new ArrayList<Integer>(1);
  if (values.size() > 0) {
    byte[] raw=null;
    if (fields != null) {
      List<Object> selectedFields=outFields.select(fields,values);
      ByteBuffer out=ByteBuffer.allocate(selectedFields.size() * 4);
      for (      Object o : selectedFields) {
        out.putInt(o.hashCode());
      }
      raw=out.array();
    }
 else {
      raw=values.get(0).toString().getBytes();
    }
    int firstChoice=(int)(Math.abs(h1.hashBytes(raw).asLong()) % this.targetTasks.size());
    int secondChoice=(int)(Math.abs(h2.hashBytes(raw).asLong()) % this.targetTasks.size());
    int selected=targetTaskStats[firstChoice] > targetTaskStats[secondChoice] ? secondChoice : firstChoice;
    boltIds.add(targetTasks.get(selected));
    targetTaskStats[selected]++;
  }
  return boltIds;
}
