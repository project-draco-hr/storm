{
  TransactionAttempt attempt=(TransactionAttempt)input.getValue(0);
  if (!_openTransactions.containsKey(attempt)) {
    ITransactionalBolt bolt=(ITransactionalBolt)Utils.deserialize(_boltSer);
    bolt.prepare(_conf,_context,attempt.getTransactionId());
    _openTransactions.put(attempt,bolt);
  }
  ITransactionalBolt bolt=_openTransactions.get(attempt);
  if (bolt != null) {
    if (input.getSourceStreamId().equals(Constants.TRANSACTION_COMMIT_STREAM_ID)) {
      bolt.commit(new TransactionTuple(input),_collector);
      _openTransactions.remove(attempt);
    }
 else {
      bolt.execute(input);
    }
  }
  _collector.ack(input);
}
