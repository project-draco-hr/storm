{
  long batchId=_rand.nextLong();
  FinishCondition finish=new FinishCondition();
  finish.msgId=msgId;
  List<Integer> tasks=_collector.emit(_stream,new ConsList(batchId,values));
  Set<Integer> outTasksSet=new HashSet<Integer>(tasks);
  for (  Integer t : _outputTasks) {
    int count=0;
    if (outTasksSet.contains(t)) {
      count=1;
    }
    long r=_rand.nextLong();
    _collector.emitDirect(t,_coordStream,new Values(batchId,count),r);
    finish.vals.add(r);
  }
  _finishConditions.put(batchId,finish);
  return tasks;
}
