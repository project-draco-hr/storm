{
  String metaStoreURI=args[0];
  String dbName=args[1];
  String tblName=args[2];
  Config conf=new Config();
  conf.setMaxSpoutPending(5);
  if (args.length == 3) {
    LocalCluster cluster=new LocalCluster();
    cluster.submitTopology("tridentHiveTopology",conf,buildTopology(metaStoreURI,dbName,tblName,null,null));
    System.out.println("waiting for 60 seconds");
    waitForSeconds(60);
    System.out.println("killing topology");
    cluster.killTopology("tridenHiveTopology");
    System.out.println("cluster shutdown");
    cluster.shutdown();
    System.out.println("cluster shutdown");
    System.exit(0);
  }
 else   if (args.length == 4) {
    try {
      StormSubmitter.submitTopology(args[3],conf,buildTopology(metaStoreURI,dbName,tblName,null,null));
    }
 catch (    Exception e) {
      System.out.println("Failed to submit topology " + e);
    }
  }
 else   if (args.length == 6) {
    try {
      StormSubmitter.submitTopology(args[3],conf,buildTopology(metaStoreURI,dbName,tblName,args[4],args[5]));
    }
 catch (    Exception e) {
      System.out.println("Failed to submit topology " + e);
    }
  }
 else {
    System.out.println("Usage: TridentHiveTopology metastoreURI dbName tableName [topologyNamey]");
  }
}
