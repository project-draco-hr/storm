{
  String value="value";
  Partition mockPartition=Mockito.mock(Partition.class);
  mockPartition.partition=0;
  int offset=0;
  config.scheme=new SchemeAsMultiScheme(new StringScheme());
  config.tupleMetaData=true;
  createTopicAndSendMessage(null,value);
  ByteBufferMessageSet messageAndOffsets=getLastMessage();
  for (  MessageAndOffset msg : messageAndOffsets) {
    Iterable<List<Object>> lists=KafkaUtils.generateTuples(config,msg.message(),mockPartition,offset);
    List<Object> values=lists.iterator().next();
    assertEquals("Incorrect number of tuple values",1,values.size());
    assertEquals("Message is incorrect",value,values.get(0));
  }
}
