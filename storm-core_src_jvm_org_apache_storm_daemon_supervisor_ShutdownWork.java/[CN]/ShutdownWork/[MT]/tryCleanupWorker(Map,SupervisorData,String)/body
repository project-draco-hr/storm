{
  try {
    String workerRoot=ConfigUtils.workerRoot(conf,workerId);
    if (Utils.checkFileExists(workerRoot)) {
      if (Utils.getBoolean(conf.get(Config.SUPERVISOR_RUN_WORKER_AS_USER),false)) {
        SupervisorUtils.rmrAsUser(conf,workerId,workerRoot);
      }
 else {
        Utils.forceDelete(ConfigUtils.workerHeartbeatsRoot(conf,workerId));
        Utils.forceDelete(ConfigUtils.workerPidsRoot(conf,workerId));
        Utils.forceDelete(ConfigUtils.workerRoot(conf,workerId));
      }
      ConfigUtils.removeWorkerUserWSE(conf,workerId);
      supervisorData.getDeadWorkers().remove(workerId);
    }
    if (conf.get(Config.STORM_RESOURCE_ISOLATION_PLUGIN_ENABLE) != null) {
      supervisorData.getResourceIsolationManager().releaseResourcesForWorker(workerId);
    }
  }
 catch (  IOException e) {
    LOG.warn("{} Failed to cleanup worker {}. Will retry later",e,workerId);
  }
catch (  RuntimeException e) {
    LOG.warn("{} Failed to cleanup worker {}. Will retry later",e,workerId);
  }
}
