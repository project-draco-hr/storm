{
  INimbus iNimbus=new TestUtilsForResourceAwareScheduler.INimbusTest();
  Map<String,Number> resourceMap=new HashMap<>();
  resourceMap.put(Config.SUPERVISOR_CPU_CAPACITY,400.0);
  resourceMap.put(Config.SUPERVISOR_MEMORY_CAPACITY_MB,2000.0);
  Map<String,SupervisorDetails> supMap=TestUtilsForResourceAwareScheduler.genSupervisors(1,2,resourceMap);
  Config config=new Config();
  config.putAll(defaultTopologyConf);
  Cluster cluster=new Cluster(iNimbus,supMap,new HashMap<String,SchedulerAssignmentImpl>(),config);
  ResourceAwareScheduler rs=new ResourceAwareScheduler();
  TopologyDetails topology1=TestUtilsForResourceAwareScheduler.getTopology("topology1",config,1,1,1,1,0,0);
  Map<String,TopologyDetails> topoMap=new HashMap<>();
  topoMap.put(topology1.getId(),topology1);
  Topologies topologies=new Topologies(topoMap);
  rs.prepare(config);
  rs.schedule(topologies,cluster);
  SchedulerAssignment assignment=cluster.getAssignmentById(topology1.getId());
  Set<WorkerSlot> assignedSlots=assignment.getSlots();
  Set<String> nodesIDs=new HashSet<>();
  for (  WorkerSlot slot : assignedSlots) {
    nodesIDs.add(slot.getNodeId());
  }
  Collection<ExecutorDetails> executors=assignment.getExecutors();
  Assert.assertEquals(1,assignedSlots.size());
  Assert.assertEquals(1,nodesIDs.size());
  Assert.assertEquals(2,executors.size());
  Assert.assertEquals("Running - Fully Scheduled by DefaultResourceAwareStrategy",cluster.getStatusMap().get(topology1.getId()));
}
