{
  Object credential=getHDFSCredential(credentials);
  final long MAX_ALLOWED_EXPIRATION_MILLIS=24 * 60 * 60* 1000;
  try {
    if (credential != null) {
      Class configurationClass=Class.forName("org.apache.hadoop.conf.Configuration");
      Object configuration=configurationClass.newInstance();
      Class credentialClass=Class.forName("org.apache.hadoop.security.Credentials");
      Class tokenClass=Class.forName("org.apache.hadoop.security.token.Token");
      Method renewMethod=tokenClass.getMethod("renew",configurationClass);
      Method getAllTokensMethod=credentialClass.getMethod("getAllTokens");
      Collection<?> tokens=(Collection<?>)getAllTokensMethod.invoke(credential);
      for (      Object token : tokens) {
        long expiration=(Long)renewMethod.invoke(token,configuration);
        if (expiration < MAX_ALLOWED_EXPIRATION_MILLIS) {
          LOG.debug("expiration {} is less then MAX_ALLOWED_EXPIRATION_MILLIS {}, getting new tokens",expiration,MAX_ALLOWED_EXPIRATION_MILLIS);
          populateCredentials(credentials,topologyConf);
        }
      }
    }
  }
 catch (  Exception e) {
    LOG.warn("could not renew the credentials, one of the possible reason is tokens are beyond " + "renewal period so attempting to get new tokens.",e);
    populateCredentials(credentials);
  }
}
