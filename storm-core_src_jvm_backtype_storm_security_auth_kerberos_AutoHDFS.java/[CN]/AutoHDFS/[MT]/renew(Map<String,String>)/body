{
  Object credential=getHDFSCredential(credentials);
  if (credential != null) {
    try {
      Class credentialClass=Class.forName("org.apache.hadoop.security.Credentials");
      Class tokenClass=Class.forName("org.apache.hadoop.security.token.Token");
      Class configurationClass=Class.forName("org.apache.hadoop.conf.Configuration");
      Object configuration=configurationClass.newInstance();
      Method renewMethod=tokenClass.getMethod("renew",configurationClass);
      Method getAllTokensMethod=credentialClass.getMethod("getAllTokens");
      List<?> tokens=(List<?>)getAllTokensMethod.invoke(credential);
      for (      Object token : tokens) {
        renewMethod.invoke(token,configuration);
      }
    }
 catch (    Exception e) {
      LOG.warn("could not renew the credentials.",e);
    }
  }
}
