{
  String topologyName=args[0];
  RecordToTupleMapper recordToTupleMapper=new TestRecordToTupleMapper();
  KinesisConnectionInfo kinesisConnectionInfo=new KinesisConnectionInfo(new CredentialsProviderChain(),new ClientConfiguration(),Regions.US_WEST_2,1000);
  org.apache.storm.kinesis.spout.Config config=new org.apache.storm.kinesis.spout.Config(args[1],ShardIteratorType.TRIM_HORIZON,recordToTupleMapper,new Date(),new ExponentialBackoffRetrier(),new ZkInfo(),kinesisConnectionInfo,10000L);
  KinesisSpout kinesisSpout=new KinesisSpout(config);
  TopologyBuilder topologyBuilder=new TopologyBuilder();
  topologyBuilder.setSpout("spout",kinesisSpout,3);
  topologyBuilder.setBolt("bolt",new KinesisBoltTest(),1).shuffleGrouping("spout");
  Config topologyConfig=new Config();
  topologyConfig.setDebug(true);
  topologyConfig.setNumWorkers(3);
  StormSubmitter.submitTopology(topologyName,topologyConfig,topologyBuilder.createTopology());
}
