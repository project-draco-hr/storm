{
  SimpleConsumer consumer=connect(partition);
  ByteBufferMessageSet msgs=consumer.fetch(new FetchRequest(_config.topic,partition % _config.partitionsPerHost,meta.offset,_config.fetchSizeBytes));
  long currOffset=meta.offset;
  for (  Message msg : msgs) {
    if (currOffset == meta.nextOffset)     break;
    if (currOffset > meta.nextOffset) {
      throw new RuntimeException("Error when re-emitting batch. overshot the end offset");
    }
    emit(attempt,collector,msg);
    currOffset+=MessageSet.entrySize(msg);
  }
}
