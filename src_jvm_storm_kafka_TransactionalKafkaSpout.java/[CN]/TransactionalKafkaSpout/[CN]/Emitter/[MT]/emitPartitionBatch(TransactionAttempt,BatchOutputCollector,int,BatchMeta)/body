{
  SimpleConsumer consumer=connect(partition);
  ByteBufferMessageSet msgs=consumer.fetch(new FetchRequest(_config.topic,partition % _config.partitionsPerHost,meta.offset,_config.fetchSizeBytes));
  long offset=meta.offset;
  for (  MessageAndOffset msg : msgs) {
    if (offset == meta.nextOffset)     break;
    if (offset > meta.nextOffset) {
      throw new RuntimeException("Error when re-emitting batch. overshot the end offset");
    }
    emit(attempt,collector,msg.message());
    offset=msg.offset();
  }
}
