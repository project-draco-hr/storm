{
  CheckPointState txState=getTxState();
  if (shouldRollback(txState)) {
    txState.state=COMMITTED;
    --txState.txid;
    saveTxState(txState);
  }
 else   if (shouldCommit(txState)) {
    txState.state=COMMITTED;
    saveTxState(txState);
  }
 else   if (shouldInitState(txState)) {
    LOG.debug("Recovery complete, current state {}",txState);
    recovering=false;
  }
}
