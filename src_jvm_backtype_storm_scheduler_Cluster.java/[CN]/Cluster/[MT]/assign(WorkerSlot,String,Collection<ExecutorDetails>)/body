{
  if (this.isSlotOccupied(slot)) {
    new RuntimeException("slot: [" + slot.getNodeId() + ", "+ slot.getPort()+ "] is already occupied.");
  }
  SchedulerAssignment assignment=this.getAssignmentById(topologyId);
  if (assignment == null) {
    assignment=new SchedulerAssignment(topologyId,new HashMap<ExecutorDetails,WorkerSlot>());
    this.assignments.put(topologyId,assignment);
  }
  assignment.assign(slot,executors);
}
