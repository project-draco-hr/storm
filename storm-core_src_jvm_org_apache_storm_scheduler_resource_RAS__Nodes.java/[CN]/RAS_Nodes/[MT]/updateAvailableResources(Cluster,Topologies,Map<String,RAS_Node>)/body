{
  if (cluster.getAssignments().size() > 0) {
    for (    Map.Entry<String,SchedulerAssignment> entry : cluster.getAssignments().entrySet()) {
      Map<ExecutorDetails,WorkerSlot> executorToSlot=entry.getValue().getExecutorToSlot();
      Map<ExecutorDetails,Double> topoMemoryResourceList=topologies.getById(entry.getKey()).getTotalMemoryResourceList();
      if (topoMemoryResourceList == null || topoMemoryResourceList.size() == 0) {
        continue;
      }
      for (      Map.Entry<ExecutorDetails,WorkerSlot> execToSlot : executorToSlot.entrySet()) {
        WorkerSlot slot=execToSlot.getValue();
        ExecutorDetails exec=execToSlot.getKey();
        RAS_Node node=nodeIdToNode.get(slot.getNodeId());
        if (!node.isAlive()) {
          continue;
        }
        if (topoMemoryResourceList.containsKey(exec)) {
          node.consumeResourcesforTask(exec,topologies.getById(entry.getKey()));
        }
 else {
          throw new IllegalStateException("Executor " + exec + "not found!");
        }
      }
    }
  }
 else {
    for (    RAS_Node n : nodeIdToNode.values()) {
      n.setAvailableMemory(n.getAvailableMemoryResources());
    }
  }
}
