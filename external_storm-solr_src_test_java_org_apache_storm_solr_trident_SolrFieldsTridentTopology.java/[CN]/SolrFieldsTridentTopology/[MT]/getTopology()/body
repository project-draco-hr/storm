{
  final TridentTopology topology=new TridentTopology();
  final SolrFieldsSpout spout=new SolrFieldsSpout();
  final Stream stream=topology.newStream("SolrFieldsSpout",spout);
  final StateFactory solrStateFactory=new SolrStateFactory(getSolrConfig(),getSolrMapper());
  stream.partitionPersist(solrStateFactory,spout.getOutputFields(),new SolrUpdater(),new Fields());
  return topology.build();
}
