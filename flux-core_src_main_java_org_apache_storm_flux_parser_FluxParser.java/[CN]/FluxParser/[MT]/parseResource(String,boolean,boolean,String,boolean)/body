{
  Yaml yaml=yaml();
  InputStream in=FluxParser.class.getResourceAsStream(resource);
  if (in == null) {
    LOG.error("Unable to load classpath resource: " + resource);
    System.exit(1);
  }
  TopologyDef topology=loadYaml(yaml,in,propertiesFile,envSub);
  in.close();
  if (dumpYaml) {
    dumpYaml(topology,yaml);
  }
  if (processIncludes) {
    return processIncludes(yaml,topology,propertiesFile,envSub);
  }
 else {
    return topology;
  }
}
