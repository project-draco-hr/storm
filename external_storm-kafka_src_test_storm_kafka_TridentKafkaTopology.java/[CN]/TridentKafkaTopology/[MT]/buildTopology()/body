{
  Fields fields=new Fields("word","count");
  FixedBatchSpout spout=new FixedBatchSpout(fields,4,new Values("storm","1"),new Values("trident","1"),new Values("needs","1"),new Values("javadoc","1"));
  spout.setCycle(true);
  TridentTopology topology=new TridentTopology();
  Stream stream=topology.newStream("spout1",spout);
  TridentKafkaStateFactory stateFactory=new TridentKafkaStateFactory().withKafkaTopicSelector(new DefaultTopicSelector("test")).withTridentTupleToKafkaKeyAndMessageMapper(new FieldNameBasedTupleToKafkaKeyAndMessageMapper("word","count"));
  stream.partitionPersist(stateFactory,fields,new TridentKafkaUpdater(),new Fields());
  return topology.build();
}
