{
  ProgressTracker tracker=new ProgressTracker();
  baseFolder=tempFolder.newFolder("trackertest");
  Path file=new Path(baseFolder.toString() + Path.SEPARATOR + "testHeadTrimming.txt");
  createTextFile(file,10);
  TextFileReader reader=new TextFileReader(fs,file,null);
  FileOffset pos0=tracker.getCommitPosition();
  Assert.assertNull(pos0);
  TextFileReader.Offset currOffset=reader.getFileOffset();
  Assert.assertNotNull(currOffset);
  Assert.assertEquals(0,currOffset.byteOffset);
  Assert.assertNotNull(reader.next());
  TextFileReader.Offset pos1=reader.getFileOffset();
  tracker.recordAckedOffset(pos1);
  TextFileReader.Offset pos1b=(TextFileReader.Offset)tracker.getCommitPosition();
  Assert.assertEquals(pos1,pos1b);
  Assert.assertNotNull(reader.next());
  TextFileReader.Offset pos2=reader.getFileOffset();
  tracker.recordAckedOffset(pos2);
  tracker.dumpState(System.err);
  TextFileReader.Offset pos2b=(TextFileReader.Offset)tracker.getCommitPosition();
  Assert.assertEquals(pos2,pos2b);
  Assert.assertNotNull(reader.next());
  TextFileReader.Offset pos3=reader.getFileOffset();
  Assert.assertNotNull(reader.next());
  TextFileReader.Offset pos4=reader.getFileOffset();
  Assert.assertNotNull(reader.next());
  TextFileReader.Offset pos5=reader.getFileOffset();
  Assert.assertNotNull(reader.next());
  TextFileReader.Offset pos6=reader.getFileOffset();
  Assert.assertNotNull(reader.next());
  TextFileReader.Offset pos7=reader.getFileOffset();
  tracker.recordAckedOffset(pos5);
  Assert.assertEquals(pos2,tracker.getCommitPosition());
  tracker.recordAckedOffset(pos4);
  Assert.assertEquals(pos2,tracker.getCommitPosition());
  tracker.recordAckedOffset(pos3);
  Assert.assertEquals(pos5,tracker.getCommitPosition());
  tracker.recordAckedOffset(pos6);
  Assert.assertEquals(pos6,tracker.getCommitPosition());
  tracker.recordAckedOffset(pos6);
  Assert.assertEquals(pos6,tracker.getCommitPosition());
  tracker.recordAckedOffset(pos7);
  Assert.assertEquals(pos7,tracker.getCommitPosition());
  tracker.dumpState(System.err);
}
