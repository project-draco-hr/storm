{
  Preconditions.checkState(null != table,"Table name must not be null");
  return new SimpleCQLStatementTupleMapper(){
    @Override public Statement map(    ITuple tuple){
      Insert stmt=QueryBuilder.insertInto(keyspace,table);
      for (      Map.Entry<String,Object> entry : valuesMapper.map(tuple).entrySet())       stmt.value(entry.getKey(),entry.getValue());
      if (ttlInSeconds != null)       stmt.using(QueryBuilder.ttl(ttlInSeconds));
      if (ifNotExist)       stmt.ifNotExists();
      if (level != null)       stmt.setConsistencyLevel(level);
      return stmt;
    }
  }
;
}
