{
  validateIds(topology);
  List<StormTopology._Fields> spoutFields=Arrays.asList(Thrift.getSpoutFields());
  for (  StormTopology._Fields field : spoutFields) {
    Map<String,Object> spoutComponents=(Map<String,Object>)topology.getFieldValue(field);
    if (spoutComponents != null) {
      for (      Object obj : spoutComponents.values()) {
        ComponentCommon common=getComponentCommon(obj);
        if (isEmptyInputs(common) == false) {
          throw new InvalidTopologyException("May not declare inputs for a spout");
        }
      }
    }
  }
  Map<String,Object> componentMap=allComponents(topology);
  for (  Object componentObj : componentMap.values()) {
    Map conf=componentConf(componentObj);
    ComponentCommon common=getComponentCommon(componentObj);
    if (common != null) {
      int parallelismHintNum=Thrift.getParallelismHint(common);
      Integer taskNum=Utils.parseInt(conf.get(Config.TOPOLOGY_TASKS));
      if (taskNum != null && taskNum > 0 && parallelismHintNum <= 0) {
        throw new InvalidTopologyException("Number of executors must be greater than 0 when number of tasks is greater than 0");
      }
    }
  }
}
