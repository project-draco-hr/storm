{
  Object tag=tuple.getValue(0);
  Integer existingIndex=_find(tag);
  if (null != existingIndex) {
    _rankings.set(existingIndex,tuple.getValues());
  }
 else {
    _rankings.add(tuple.getValues());
  }
  Collections.sort(_rankings,new Comparator<List>(){
    public int compare(    List o1,    List o2){
      return _compare(o1,o2);
    }
  }
);
  if (_rankings.size() > _count) {
    _rankings.remove(_count);
  }
  long currentTime=System.currentTimeMillis();
  if (_lastTime == null || currentTime >= _lastTime + 2000) {
    collector.emit(new Values(JSONValue.toJSONString(_rankings)));
    _lastTime=currentTime;
  }
}
