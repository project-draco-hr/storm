{
  StormTopology topology=null;
  buildComponents(context);
  if (context.getTopologyDef().isDslTopology()) {
    LOG.info("Detected DSL topology...");
    TopologyBuilder builder=new TopologyBuilder();
    buildSpouts(context,builder);
    buildBolts(context);
    buildStreamDefinitions(context,builder);
    topology=builder.createTopology();
  }
 else {
    LOG.info("A topology source has been specified...");
    ObjectDef def=context.getTopologyDef().getTopologySource();
    topology=buildExternalTopology(def,context);
  }
  return topology;
}
