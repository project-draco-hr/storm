{
  Class clazz=Class.forName(def.getClassName());
  CustomStreamGrouping grouping=null;
  if (def.hasConstructorArgs()) {
    LOG.debug("Found constructor arguments in definition: " + def.getConstructorArgs().getClass().getName());
    List<Object> cArgs=resolveReferences(def,context);
    Constructor con=findCompatibleConstructor(cArgs,clazz);
    if (con != null) {
      LOG.debug("Found something seemingly compatible, attempting invocation...");
      grouping=(CustomStreamGrouping)con.newInstance(getConstructorArgsWithListCoercian(cArgs,con));
    }
 else {
      throw new IllegalArgumentException("Couldn't find a suitable StreamGroping constructor.");
    }
  }
 else {
    grouping=(CustomStreamGrouping)clazz.newInstance();
  }
  applyProperties(def,grouping,context);
  return grouping;
}
