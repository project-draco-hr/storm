{
  try {
    this.collector=outputCollector;
synchronized (AbstractEsBolt.class) {
      if (client == null) {
        Settings settings=ImmutableSettings.settingsBuilder().put("cluster.name",esConfig.getClusterName()).put("client.transport.sniff","false").build();
        List<InetSocketTransportAddress> transportAddressList=new ArrayList<InetSocketTransportAddress>();
        for (        String node : esConfig.getNodes()) {
          String[] hostAndPort=node.split(":");
          if (hostAndPort.length != 2) {
            throw new Exception("incorrect ElasticSearch node format, should follow {host}:{port} pattern");
          }
          transportAddressList.add(new InetSocketTransportAddress(hostAndPort[0],Integer.parseInt(hostAndPort[1])));
        }
        client=new TransportClient(settings).addTransportAddresses(transportAddressList.toArray(new InetSocketTransportAddress[transportAddressList.size()]));
      }
    }
  }
 catch (  Exception e) {
    LOG.warn("unable to initialize EsBolt ",e);
  }
}
