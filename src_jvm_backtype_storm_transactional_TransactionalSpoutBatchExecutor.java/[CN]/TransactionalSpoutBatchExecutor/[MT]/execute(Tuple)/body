{
  TransactionAttempt attempt=(TransactionAttempt)input.getValue(0);
  if (input.getSourceStreamId().equals(TransactionalSpoutCoordinator.TRANSACTION_COMMIT_STREAM_ID)) {
    _collector.ack(input);
    _emitter.cleanupBefore(attempt.getTransactionId());
  }
 else {
    _emitter.emitBatch(attempt,input.getValue(1),_collector);
    _collector.ack(input);
  }
}
