{
  TransactionAttempt attempt=(TransactionAttempt)input.getValue(0);
  try {
    _emitter.emitBatch(attempt,input.getValue(1),_collector);
    _collector.ack(input);
  }
 catch (  FailedException e) {
    LOG.warn("Failed to emit batch for transaction",e);
    _collector.fail(input);
  }
  _emitter.cleanupBefore((BigInteger)input.getValue(2));
}
