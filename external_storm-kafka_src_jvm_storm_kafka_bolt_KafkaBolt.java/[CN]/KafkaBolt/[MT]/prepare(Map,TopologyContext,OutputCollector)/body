{
  if (mapper == null) {
    this.mapper=new FieldNameBasedTupleToKafkaMapper<K,V>();
  }
  if (topicSelector == null) {
    this.topicSelector=new DefaultTopicSelector((String)stormConf.get(TOPIC));
  }
  Map configMap=(Map)stormConf.get(KAFKA_BROKER_PROPERTIES);
  Properties properties=new Properties();
  if (configMap != null)   properties.putAll(configMap);
  if (boltSpecfiedProperties != null)   properties.putAll(boltSpecfiedProperties);
  producer=new KafkaProducer<K,V>(properties);
  this.collector=collector;
}
