{
  K key=null;
  V message=null;
  try {
    key=mapper.getKeyFromTuple(input);
    message=mapper.getMessageFromTuple(input);
    for (    String topic : topicSelector.getTopics(input)) {
      producer.send(new KeyedMessage<K,V>(topic,key,message));
    }
  }
 catch (  Exception ex) {
    LOG.error("Could not send message with key '" + key + "' and value '"+ message+ "'",ex);
  }
 finally {
    collector.ack(input);
  }
}
