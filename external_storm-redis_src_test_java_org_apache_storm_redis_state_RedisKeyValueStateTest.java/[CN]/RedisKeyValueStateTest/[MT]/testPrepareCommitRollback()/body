{
  keyValueState.put("a","1");
  keyValueState.put("b","2");
  keyValueState.prepareCommit(1);
  keyValueState.put("c","3");
  assertEquals("1",keyValueState.get("a"));
  assertEquals("2",keyValueState.get("b"));
  assertEquals("3",keyValueState.get("c"));
  keyValueState.rollback();
  assertEquals(null,keyValueState.get("a"));
  assertEquals(null,keyValueState.get("b"));
  assertEquals(null,keyValueState.get("c"));
  keyValueState.put("a","1");
  keyValueState.put("b","2");
  keyValueState.prepareCommit(1);
  keyValueState.commit(1);
  keyValueState.put("c","3");
  assertEquals("1",keyValueState.get("a"));
  assertEquals("2",keyValueState.get("b"));
  assertEquals("3",keyValueState.get("c"));
  keyValueState.rollback();
  assertEquals("1",keyValueState.get("a"));
  assertEquals("2",keyValueState.get("b"));
  assertEquals(null,keyValueState.get("c"));
}
