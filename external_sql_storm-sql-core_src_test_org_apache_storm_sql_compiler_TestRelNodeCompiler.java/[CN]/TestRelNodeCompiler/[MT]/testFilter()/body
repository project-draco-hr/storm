{
  String sql="SELECT ID + 1 FROM FOO WHERE ID > 3";
  TestUtils.CalciteState state=TestUtils.sqlOverDummyTable(sql);
  JavaTypeFactory typeFactory=new JavaTypeFactoryImpl(RelDataTypeSystem.DEFAULT);
  LogicalProject project=(LogicalProject)state.tree;
  LogicalFilter filter=(LogicalFilter)project.getInput();
  TableScan scan=(TableScan)filter.getInput();
  try (StringWriter sw=new StringWriter();PrintWriter pw=new PrintWriter(sw)){
    RelNodeCompiler compiler=new RelNodeCompiler(pw,typeFactory);
    compiler.visitTableScan(scan);
    pw.flush();
    Assert.assertTrue(sw.toString().contains("_datasources[TABLE_FOO]"));
  }
   try (StringWriter sw=new StringWriter();PrintWriter pw=new PrintWriter(sw)){
    RelNodeCompiler compiler=new RelNodeCompiler(pw,typeFactory);
    compiler.visitFilter(filter);
    pw.flush();
    Assert.assertTrue(sw.toString().contains("t0 > 3"));
  }
   try (StringWriter sw=new StringWriter();PrintWriter pw=new PrintWriter(sw)){
    RelNodeCompiler compiler=new RelNodeCompiler(pw,typeFactory);
    compiler.visitProject(project);
    pw.flush();
    Assert.assertTrue(sw.toString().contains("t0 + 1"));
  }
 }
