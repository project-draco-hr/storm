{
  try {
    String topicBrokersPath=partitionPath();
    byte[] hostPortData=_curator.getData().forPath(topicBrokersPath + "/" + partition+ "/state");
    Map<Object,Object> value=(Map<Object,Object>)JSONValue.parse(new String(hostPortData,"UTF-8"));
    Integer leader=((Number)value.get("leader")).intValue();
    return leader;
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
