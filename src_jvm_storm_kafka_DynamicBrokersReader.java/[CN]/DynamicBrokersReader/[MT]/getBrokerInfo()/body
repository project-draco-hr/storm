{
  Map<String,List> ret=new HashMap();
  try {
    String brokerInfoPath=_zkPath + "/ids";
    List<String> brokerIds=_curator.getChildren().forPath(brokerInfoPath);
    for (    String brokerId : brokerIds) {
      try {
        byte[] hostPortData=_curator.getData().forPath(brokerInfoPath + "/" + brokerId);
        HostPort hp=getBrokerHost(hostPortData);
        int numPartitions=getNumPartitions();
        List info=new ArrayList();
        info.add((long)hp.port);
        info.add((long)numPartitions);
        ret.put(hp.host,info);
      }
 catch (      org.apache.zookeeper.KeeperException.NoNodeException e) {
        e.printStackTrace();
      }
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return ret;
}
