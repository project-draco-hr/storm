{
  if (conf == null) {
    LOG.error("conf cannot be null");
  }
  validateConfig(conf);
  if (zkStr == null) {
    LOG.error("zkString cannot be null");
  }
  if (zkPath == null) {
    LOG.error("zkPath cannot be null");
  }
  if (topic == null) {
    LOG.error("topic cannot be null");
  }
  _zkPath=zkPath;
  _topic=topic;
  try {
    _curator=CuratorFrameworkFactory.newClient(zkStr,Utils.getInt(conf.get(Config.STORM_ZOOKEEPER_SESSION_TIMEOUT)),Utils.getInt(conf.get(Config.STORM_ZOOKEEPER_CONNECTION_TIMEOUT)),new RetryNTimes(Utils.getInt(conf.get(Config.STORM_ZOOKEEPER_RETRY_TIMES)),Utils.getInt(conf.get(Config.STORM_ZOOKEEPER_RETRY_INTERVAL))));
    _curator.start();
  }
 catch (  Exception ex) {
    LOG.error("Couldn't connect to zookeeper",ex);
    throw new RuntimeException(ex);
  }
}
