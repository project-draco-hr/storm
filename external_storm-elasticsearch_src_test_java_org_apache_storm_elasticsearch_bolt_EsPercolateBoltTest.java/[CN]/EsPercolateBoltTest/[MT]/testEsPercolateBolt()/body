{
  EsConfig esConfig=new EsConfig();
  esConfig.setClusterName("test-cluster");
  esConfig.setNodes(new String[]{"localhost:9300"});
  EsTupleMapper tupleMapper=EsTestUtil.generateDefaultTupleMapper();
  bolt=new EsPercolateBolt(esConfig,tupleMapper);
  bolt.prepare(config,null,collector);
  String source="{\"user\":\"user1\"}";
  String index="index1";
  String type=".percolator";
  node.client().prepareIndex("index1",".percolator").setId("1").setSource("{\"query\":{\"match\":{\"user\":\"user1\"}}}").execute().actionGet();
  Tuple tuple=EsTestUtil.generateTestTuple(source,index,type,null);
  bolt.execute(tuple);
  verify(collector).ack(tuple);
  verify(collector).emit(new Values(source,any(PercolateResponse.Match.class)));
  bolt.cleanup();
}
