{
  _collector=collector;
  List<String> zkServers=_spoutConfig.zkServers;
  if (zkServers == null)   zkServers=(List<String>)conf.get(Config.STORM_ZOOKEEPER_SERVERS);
  _state=new KafkaSpoutState(zkServers);
  _connections=new DynamicPartitionConnections(_spoutConfig);
  int totalTasks=context.getComponentTasks(context.getThisComponentId()).size();
  if (_spoutConfig.hosts instanceof KafkaConfig.StaticHosts) {
    _coordinator=new StaticCoordinator(_connections,_spoutConfig,_state,context.getThisTaskIndex(),totalTasks,_uuid);
  }
 else {
    _coordinator=new ZkCoordinator(_connections,conf,_spoutConfig,_state,context.getThisTaskIndex(),totalTasks,_uuid);
  }
}
