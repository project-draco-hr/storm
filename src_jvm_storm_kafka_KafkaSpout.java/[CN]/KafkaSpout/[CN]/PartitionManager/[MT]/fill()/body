{
  SimpleConsumer consumer=_partitions.getConsumer(_partition);
  int hostPartition=_partitions.getHostPartition(_partition);
  LOG.info("Fetching from Kafka: " + consumer.host() + ":"+ hostPartition+ " from offset "+ _emittedToOffset);
  ByteBufferMessageSet msgs=consumer.fetch(new FetchRequest(_spoutConfig.topic,hostPartition,_emittedToOffset,_spoutConfig.fetchSizeBytes));
  LOG.info("Fetched " + msgs.underlying().size() + " messages from Kafka: "+ consumer.host()+ ":"+ hostPartition);
  for (  MessageAndOffset msg : msgs) {
    _pending.add(_emittedToOffset);
    _waitingToEmit.add(new MessageAndRealOffset(msg.message(),_emittedToOffset));
    _emittedToOffset=msg.offset();
  }
}
