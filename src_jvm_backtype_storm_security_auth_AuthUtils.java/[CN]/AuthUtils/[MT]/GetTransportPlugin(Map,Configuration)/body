{
  ITransportPlugin transportPlugin=null;
  try {
    String transport_plugin_klassName=(String)storm_conf.get(Config.STORM_THRIFT_TRANSPORT_PLUGIN_CLASS);
    String transport_plugin_jar=(String)storm_conf.get(Config.STORM_THRIFT_TRANSPORT_PLUGIN_JAR);
    Class klass=null;
    if (transport_plugin_jar == null)     klass=Class.forName(transport_plugin_klassName);
 else {
      URL url=new URL("jar:file:" + transport_plugin_jar + "!/");
      LOG.debug("Plugin URL:" + url);
      URL[] urls=new URL[]{url};
      ClassLoader loader=new URLClassLoader(urls);
      klass=loader.loadClass(transport_plugin_klassName);
    }
    transportPlugin=(ITransportPlugin)klass.getConstructor(Configuration.class).newInstance(login_conf);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return transportPlugin;
}
