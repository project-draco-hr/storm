{
  JsonSerializer serializer=new JsonSerializer(fieldNames);
  SqlKafkaMapper m=new SqlKafkaMapper(primaryKeyIndex,serializer);
  state=new TridentKafkaState().withKafkaTopicSelector(new DefaultTopicSelector(topic)).withTridentTupleToKafkaMapper(m);
  state.prepare(producerProperties);
}
