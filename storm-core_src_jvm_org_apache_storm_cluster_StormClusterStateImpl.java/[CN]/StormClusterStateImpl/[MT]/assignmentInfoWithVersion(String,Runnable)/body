{
  Map map=new HashMap();
  if (callback != null) {
    assignmentInfoWithVersionCallback.put(stormId,callback);
  }
  Assignment assignment=null;
  Integer version=0;
  Map dataWithVersionMap=stateStorage.get_data_with_version(ClusterUtils.assignmentPath(stormId),callback != null);
  if (dataWithVersionMap != null) {
    assignment=ClusterUtils.maybeDeserialize((byte[])dataWithVersionMap.get(IStateStorage.DATA),Assignment.class);
    version=(Integer)dataWithVersionMap.get(IStateStorage.VERSION);
  }
  map.put(IStateStorage.DATA,assignment);
  map.put(IStateStorage.VERSION,version);
  return map;
}
