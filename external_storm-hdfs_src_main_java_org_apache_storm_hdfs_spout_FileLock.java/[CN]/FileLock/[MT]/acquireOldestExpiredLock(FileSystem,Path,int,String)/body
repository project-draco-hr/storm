{
  long olderThan=System.currentTimeMillis() - (locktimeoutSec * 1000);
  Collection<Path> listing=HdfsUtils.listFilesByModificationTime(fs,lockFilesDir,olderThan);
  for (  Path file : listing) {
    if (file.getName().equalsIgnoreCase(DirLock.DIR_LOCK_FILE))     continue;
    LogEntry lastEntry=getLastEntryIfStale(fs,file,olderThan);
    if (lastEntry != null)     return FileLock.takeOwnership(fs,file,lastEntry,spoutId);
  }
  log.info("No abandoned files found");
  return null;
}
