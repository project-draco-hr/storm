{
  int size=0;
  ArrayList<Object> requests=new ArrayList<Object>();
  requests.add(message_queue.take());
  for (Object msg=message_queue.poll(); msg != null; msg=message_queue.poll()) {
    requests.add(msg);
    if (msg == ControlMessage.CLOSE_MESSAGE)     break;
    TaskMessage taskMsg=(TaskMessage)msg;
    size+=(taskMsg.message() != null ? taskMsg.message().length : 0) + 6;
    if (size > buffer_size)     break;
  }
  return requests;
}
