{
  ArrayList<Object> requests=new ArrayList<Object>();
  Object msg=message_queue.take();
  requests.add(msg);
  if (msg == ControlMessage.CLOSE_MESSAGE)   return requests;
  int size=msgSize((TaskMessage)msg);
  while (size < buffer_size) {
    msg=message_queue.peek();
    if (msg == null)     break;
    if (msg == ControlMessage.CLOSE_MESSAGE) {
      message_queue.take();
      requests.add(msg);
      break;
    }
    size+=msgSize((TaskMessage)msg);
    if (size > buffer_size)     break;
    message_queue.take();
    requests.add(msg);
  }
  return requests;
}
