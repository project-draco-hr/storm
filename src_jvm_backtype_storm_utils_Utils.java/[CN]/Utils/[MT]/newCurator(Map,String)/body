{
  List<String> serverPorts=new ArrayList<String>();
  for (  String zkServer : (List<String>)conf.get(Config.STORM_ZOOKEEPER_SERVERS)) {
    serverPorts.add(zkServer + Utils.getInt(conf.get(Config.STORM_ZOOKEEPER_PORT)));
  }
  String zkStr=StringUtils.join(serverPorts,",") + root;
  try {
    CuratorFramework ret=CuratorFrameworkFactory.newClient(zkStr,Utils.getInt(conf.get(Config.STORM_ZOOKEEPER_SESSION_TIMEOUT)),15000,new RetryNTimes(5,1000));
    ret.start();
    return ret;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
