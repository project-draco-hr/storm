{
  this.type=type;
  this.server=server;
  this.options=options;
  this.factory=factory;
  if (options.serializer == null) {
    serializer=DEFAULT_SERIALIZERS.get(type);
    if (serializer == null) {
      throw new RuntimeException("Couldn't find serializer for state type: " + type);
    }
  }
 else {
    this.serializer=options.serializer;
  }
}
