{
  if (!cmd.hasOption(OPTION_NO_SPLASH)) {
    printSplash();
  }
  boolean dumpYaml=cmd.hasOption("dump-yaml");
  TopologyDef topologyDef=null;
  String filePath=(String)cmd.getArgList().get(0);
  if (cmd.hasOption(OPTION_RESOURCE)) {
    printf("Parsing classpath resource: %s",filePath);
    topologyDef=FluxParser.parseResource(filePath,dumpYaml,true);
  }
 else {
    printf("Parsing file: %s",new File(filePath).getAbsolutePath());
    topologyDef=FluxParser.parseFile(filePath,dumpYaml,true);
  }
  String topologyName=topologyDef.getName();
  Config conf=FluxBuilder.buildConfig(topologyDef);
  ExecutionContext context=new ExecutionContext(topologyDef,conf);
  StormTopology topology=FluxBuilder.buildTopology(context);
  if (!cmd.hasOption(OPTION_NO_DETAIL)) {
    printTopologyInfo(context);
  }
  if (!cmd.hasOption(OPTION_DRY_RUN)) {
    if (cmd.hasOption(OPTION_REMOTE)) {
      LOG.info("Running remotely...");
      try {
        SubmitOptions submitOptions=null;
        if (cmd.hasOption(OPTION_INACTIVE)) {
          LOG.info("Deploying topology in an INACTIVE state...");
          submitOptions=new SubmitOptions(TopologyInitialStatus.INACTIVE);
        }
 else {
          LOG.info("Deploying topology in an ACTIVE state...");
          submitOptions=new SubmitOptions(TopologyInitialStatus.ACTIVE);
        }
        StormSubmitter.submitTopology(topologyName,conf,topology,submitOptions);
      }
 catch (      Exception e) {
        LOG.warn("Unable to deploy topology to remote cluster.",e);
      }
    }
 else {
      LOG.info("Running in local mode...");
      String sleepStr=cmd.getOptionValue(OPTION_SLEEP);
      Long sleepTime=DEFAULT_LOCAL_SLEEP_TIME;
      if (sleepStr != null) {
        sleepTime=Long.parseLong(sleepStr);
      }
      LOG.debug("Sleep time: {}",sleepTime);
      LocalCluster cluster=new LocalCluster();
      cluster.submitTopology(topologyName,conf,topology);
      Utils.sleep(sleepTime);
      cluster.killTopology(topologyName);
      cluster.shutdown();
    }
  }
}
