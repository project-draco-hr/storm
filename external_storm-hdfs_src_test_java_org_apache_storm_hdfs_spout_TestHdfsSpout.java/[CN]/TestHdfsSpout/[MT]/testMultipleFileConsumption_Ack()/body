{
  Path file1=new Path(source.toString() + "/file1.txt");
  createTextFile(file1,5);
  HdfsSpout spout=makeSpout(Configs.TEXT,TextFileReader.defaultFields);
  spout.setCommitFrequencyCount(1);
  spout.setCommitFrequencySec(1);
  Map conf=getCommonConfigs();
  conf.put(Config.TOPOLOGY_ACKER_EXECUTORS,"1");
  openSpout(spout,0,conf);
  runSpout(spout,"r3");
  FileReader reader=getField(spout,"reader");
  Assert.assertNotNull(reader);
  Assert.assertEquals(false,getBoolField(spout,"fileReadCompletely"));
  runSpout(spout,"r3");
  reader=getField(spout,"reader");
  Assert.assertNotNull(reader);
  Assert.assertEquals(true,getBoolField(spout,"fileReadCompletely"));
  runSpout(spout,"a0","a1","a2");
  reader=getField(spout,"reader");
  Assert.assertNotNull(reader);
  Assert.assertEquals(true,getBoolField(spout,"fileReadCompletely"));
  runSpout(spout,"a3","a4");
  reader=getField(spout,"reader");
  Assert.assertNull(reader);
  Assert.assertEquals(true,getBoolField(spout,"fileReadCompletely"));
  Path file2=new Path(source.toString() + "/file2.txt");
  createTextFile(file2,5);
  runSpout(spout,"r1");
  Assert.assertNotNull(getField(spout,"reader"));
  Assert.assertEquals(false,getBoolField(spout,"fileReadCompletely"));
  runSpout(spout,"a5");
  Assert.assertNotNull(getField(spout,"reader"));
  Assert.assertEquals(false,getBoolField(spout,"fileReadCompletely"));
  runSpout(spout,"r5","a6","a7","a8","a9");
  Assert.assertNull(getField(spout,"reader"));
  Assert.assertEquals(true,getBoolField(spout,"fileReadCompletely"));
}
