{
  if (obj instanceof ControlMessage) {
    return ((ControlMessage)obj).buffer();
  }
  ChannelBufferOutputStream bout;
  if (obj instanceof ArrayList<?>) {
    bout=new ChannelBufferOutputStream(ChannelBuffers.dynamicBuffer(estimated_buffer_size,ctx.getChannel().getConfig().getBufferFactory()));
    ArrayList<TaskMessage> messages=(ArrayList<TaskMessage>)obj;
    for (    TaskMessage message : messages)     writeTaskMessage(bout,message);
    ControlMessage.eobMessage().write(bout);
    bout.close();
    return bout.buffer();
  }
  throw new RuntimeException("Unsupported encoding of object of class " + obj.getClass().getName());
}
