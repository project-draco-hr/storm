{
  try {
    byte[] bytes=this.format.format(tuple);
    out.write(bytes);
    this.collector.ack(tuple);
    if (this.syncPolicy.mark(tuple,bytes)) {
      long start=System.currentTimeMillis();
      this.out.hsync();
      this.syncPolicy.reset();
    }
    if (this.rotationPolicy.mark(tuple,bytes)) {
      rotateOutputFile();
      this.rotationPolicy.reset();
    }
  }
 catch (  IOException e) {
    LOG.warn("write/sync failed.",e);
    this.collector.fail(tuple);
  }
}
