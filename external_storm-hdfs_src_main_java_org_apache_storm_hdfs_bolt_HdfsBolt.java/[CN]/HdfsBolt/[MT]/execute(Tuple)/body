{
  try {
    byte[] bytes=this.format.format(tuple);
synchronized (this.writeLock) {
      out.write(bytes);
      this.offset+=bytes.length;
      if (this.syncPolicy.mark(tuple,this.offset)) {
        if (this.out instanceof HdfsDataOutputStream) {
          ((HdfsDataOutputStream)this.out).hsync(EnumSet.of(SyncFlag.UPDATE_LENGTH));
        }
 else {
          this.out.hsync();
        }
        this.syncPolicy.reset();
      }
    }
    this.collector.ack(tuple);
    if (this.rotationPolicy.mark(tuple,this.offset)) {
      rotateOutputFile();
      this.offset=0;
      this.rotationPolicy.reset();
    }
  }
 catch (  IOException e) {
    this.collector.reportError(e);
    this.collector.fail(tuple);
  }
}
