{
  Connection connection=null;
  Map<String,Integer> columnSchemaMap=new HashMap<String,Integer>();
  try {
    connection=this.dataSource.getConnection();
    DatabaseMetaData metaData=connection.getMetaData();
    ResultSet resultSet=metaData.getColumns(null,null,tableName,null);
    while (resultSet.next()) {
      columnSchemaMap.put(resultSet.getString("COLUMN_NAME"),resultSet.getInt("DATA_TYPE"));
    }
    return columnSchemaMap;
  }
 catch (  SQLException e) {
    throw new RuntimeException("Failed to get schema for table " + tableName,e);
  }
 finally {
    closeConnection(connection);
  }
}
