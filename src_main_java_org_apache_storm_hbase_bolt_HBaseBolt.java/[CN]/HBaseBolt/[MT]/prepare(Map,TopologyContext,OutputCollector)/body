{
  this.collector=collector;
  Configuration hbConfig=HBaseConfiguration.create();
  String hbRoot=(String)map.get("hbase.rootdir");
  if (hbRoot != null) {
    LOG.info("Using hbase.rootdir={}",hbRoot);
    hbConfig.set("hbase.rootdir",hbRoot);
  }
  try {
    this.table=new HTable(hbConfig,this.tableName);
  }
 catch (  IOException e) {
    throw new RuntimeException("HBase bolt preparation failed: " + e.getMessage(),e);
  }
}
