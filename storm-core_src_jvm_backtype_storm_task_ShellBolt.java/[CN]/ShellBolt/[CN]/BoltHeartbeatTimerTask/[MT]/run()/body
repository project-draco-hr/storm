{
  long currentTimeMillis=System.currentTimeMillis();
  long lastHeartbeat=getLastHeartbeat();
  LOG.debug("BOLT - current time : {}, last heartbeat : {}, worker timeout (ms) : {}",currentTimeMillis,lastHeartbeat,workerTimeoutMills);
  if (currentTimeMillis - lastHeartbeat > workerTimeoutMills) {
    bolt.die(new RuntimeException("subprocess heartbeat timeout"));
  }
  String genId=Long.toString(_rand.nextLong());
  try {
    _pendingWrites.put(createHeartbeatBoltMessage(genId));
  }
 catch (  InterruptedException e) {
    String processInfo=_process.getProcessInfoString() + _process.getProcessTerminationInfoString();
    bolt.die(new RuntimeException("Error during multilang processing " + processInfo,e));
  }
}
