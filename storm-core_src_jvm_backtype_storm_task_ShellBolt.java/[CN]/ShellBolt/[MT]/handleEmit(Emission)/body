{
  List<Tuple> anchors=new ArrayList<Tuple>();
  for (  String anchor : emission.getAnchors()) {
    Tuple t=_inputs.get(anchor);
    if (t == null) {
      throw new RuntimeException("Anchored onto " + anchor + " after ack/fail");
    }
    anchors.add(t);
  }
  if (emission.getTask() == 0) {
    List<Integer> outtasks=_collector.emit(emission.getStream(),anchors,emission.getTuple());
    _pendingWrites.put(outtasks);
  }
 else {
    _collector.emitDirect((int)emission.getTask(),emission.getStream(),anchors,emission.getTuple());
  }
}
