{
  long totalStatted=0;
  boolean topologyFound=false;
  boolean componentFound=false;
  boolean streamFound=false;
  int slotsUsed=0;
  int executors=0;
  int executorsWithMetrics=0;
  ClusterSummary summary=client.getClusterInfo();
  for (  TopologySummary ts : summary.get_topologies()) {
    if (_topology.equals(ts.get_name())) {
      topologyFound=true;
      slotsUsed=ts.get_num_workers();
      String id=ts.get_id();
      TopologyInfo info=client.getTopologyInfo(id);
      for (      ExecutorSummary es : info.get_executors()) {
        if (_component.equals(es.get_component_id())) {
          componentFound=true;
          executors++;
          ExecutorStats stats=es.get_stats();
          if (stats != null) {
            Map<String,Map<String,Long>> statted=WATCH_EMITTED.equals(_watch) ? stats.get_emitted() : stats.get_transferred();
            if (statted != null) {
              Map<String,Long> e2=statted.get(":all-time");
              if (e2 != null) {
                Long stream=e2.get(_stream);
                if (stream != null) {
                  streamFound=true;
                  executorsWithMetrics++;
                  totalStatted+=stream;
                }
              }
            }
          }
        }
      }
    }
  }
  if (!topologyFound) {
    throw new IllegalArgumentException("topology: " + _topology + " not found");
  }
  if (!componentFound) {
    throw new IllegalArgumentException("component: " + _component + " not fouond");
  }
  if (!streamFound) {
    throw new IllegalArgumentException("stream: " + _stream + " not fouond");
  }
  long timeDelta=now - state.lastTime;
  long stattedDelta=totalStatted - state.lastStatted;
  state.lastTime=now;
  state.lastStatted=totalStatted;
  double throughput=(stattedDelta == 0 || timeDelta == 0) ? 0.0 : ((double)stattedDelta / (double)timeDelta);
  System.out.println(_topology + "\t" + slotsUsed+ "\t"+ executors+ "\t"+ executorsWithMetrics+ "\t"+ _component+ "\t"+ _stream+ "\t"+ timeDelta+ "\t"+ stattedDelta+ "\t"+ throughput);
}
