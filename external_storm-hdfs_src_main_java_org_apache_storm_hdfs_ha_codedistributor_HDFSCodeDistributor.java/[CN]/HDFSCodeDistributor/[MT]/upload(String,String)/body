{
  File localStormDir=new File(dirPath);
  LOG.info("Copying the storm code from directory: {} to {}{}{}",localStormDir.getAbsolutePath(),stormDir.toString(),lineSeparator().toString(),topologyId);
  File[] files=localStormDir.listFiles();
  Path hdfsDestPath=new Path(stormDir,new Path(topologyId));
  fs.mkdirs(hdfsDestPath);
  for (  File file : files) {
    fs.copyFromLocalFile(new Path(file.getAbsolutePath()),hdfsDestPath);
  }
  File file=new File(dirPath,topologyId + ".torrent");
  RemoteIterator<LocatedFileStatus> hdfsFileIterator=fs.listFiles(hdfsDestPath,false);
  BufferedWriter writer=new BufferedWriter(new FileWriter(file));
  while (hdfsFileIterator.hasNext()) {
    writer.write(hdfsFileIterator.next().getPath().toString());
    writer.newLine();
  }
  writer.close();
  return file;
}
