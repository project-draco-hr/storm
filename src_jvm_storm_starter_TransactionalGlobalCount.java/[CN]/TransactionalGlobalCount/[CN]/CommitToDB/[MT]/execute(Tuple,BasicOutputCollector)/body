{
  BigInteger txid=((TransactionAttempt)tuple.getValue(0)).getTransactionId();
  int sum=tuple.getInteger(1);
  Value val=DATABASE.get(GLOBAL_COUNT_KEY);
  Value newval;
  if (val == null || !val.txid.equals(txid)) {
    newval=new Value();
    newval.txid=txid;
    if (val == null) {
      newval.count=sum;
    }
 else {
      newval.count=sum + val.count;
    }
    DATABASE.put(GLOBAL_COUNT_KEY,newval);
  }
 else {
    newval=val;
  }
  collector.emit(new Values(tuple.getValue(0),newval.count));
}
